# -*- Makefile -*-
### Makefile - VHDL Makefile generated by Emacs VHDL Mode 3.33.6

# Directory : "/gpfs/iot/projects/BCM4350/work/anand/uvm_playground/uvmHelloWorld/design/asqrt/src/cdc/"
# Platform  : ModelSim
# Generated : 2021-03-23 12:10:29 ansn


# Define compilation command and options

COMPILE = vcom
OPTIONS = -93 -work $(basename $(notdir $(shell pwd)))


# Define library paths

LIBRARY-$(basename $(notdir $(shell pwd))) = work


# Define library unit files

UNIT-$(basename $(notdir $(shell pwd)))-afifo = \
	$(LIBRARY-$(basename $(notdir $(shell pwd))))/afifo/_primary.dat
UNIT-$(basename $(notdir $(shell pwd)))-afifo-rtl = \
	$(LIBRARY-$(basename $(notdir $(shell pwd))))/afifo/rtl.dat
UNIT-$(basename $(notdir $(shell pwd)))-afifo_rptr_empty = \
	$(LIBRARY-$(basename $(notdir $(shell pwd))))/afifo_rptr_empty/_primary.dat
UNIT-$(basename $(notdir $(shell pwd)))-afifo_rptr_empty-rtl = \
	$(LIBRARY-$(basename $(notdir $(shell pwd))))/afifo_rptr_empty/rtl.dat
UNIT-$(basename $(notdir $(shell pwd)))-afifo_wptr_full = \
	$(LIBRARY-$(basename $(notdir $(shell pwd))))/afifo_wptr_full/_primary.dat
UNIT-$(basename $(notdir $(shell pwd)))-afifo_wptr_full-rtl = \
	$(LIBRARY-$(basename $(notdir $(shell pwd))))/afifo_wptr_full/rtl.dat
UNIT-$(basename $(notdir $(shell pwd)))-cdc_pkg = \
	$(LIBRARY-$(basename $(notdir $(shell pwd))))/cdc_pkg/_primary.dat
UNIT-$(basename $(notdir $(shell pwd)))-dbl_sync = \
	$(LIBRARY-$(basename $(notdir $(shell pwd))))/dbl_sync/_primary.dat
UNIT-$(basename $(notdir $(shell pwd)))-dbl_sync-rtl = \
	$(LIBRARY-$(basename $(notdir $(shell pwd))))/dbl_sync/rtl.dat
UNIT-$(basename $(notdir $(shell pwd)))-dpram = \
	$(LIBRARY-$(basename $(notdir $(shell pwd))))/dpram/_primary.dat
UNIT-$(basename $(notdir $(shell pwd)))-dpram-rtl = \
	$(LIBRARY-$(basename $(notdir $(shell pwd))))/dpram/rtl.dat


# Define list of all library unit files

ALL_UNITS = \
	$(UNIT-$(basename $(notdir $(shell pwd)))-afifo) \
	$(UNIT-$(basename $(notdir $(shell pwd)))-afifo-rtl) \
	$(UNIT-$(basename $(notdir $(shell pwd)))-afifo_rptr_empty) \
	$(UNIT-$(basename $(notdir $(shell pwd)))-afifo_rptr_empty-rtl) \
	$(UNIT-$(basename $(notdir $(shell pwd)))-afifo_wptr_full) \
	$(UNIT-$(basename $(notdir $(shell pwd)))-afifo_wptr_full-rtl) \
	$(UNIT-$(basename $(notdir $(shell pwd)))-cdc_pkg) \
	$(UNIT-$(basename $(notdir $(shell pwd)))-dbl_sync) \
	$(UNIT-$(basename $(notdir $(shell pwd)))-dbl_sync-rtl) \
	$(UNIT-$(basename $(notdir $(shell pwd)))-dpram) \
	$(UNIT-$(basename $(notdir $(shell pwd)))-dpram-rtl)



# Rule for compiling entire design

all : \
		library \
		$(ALL_UNITS)


# Rule for cleaning entire design

clean : 
	-rm -f $(ALL_UNITS)


# Rule for creating library directory

library : \
		$(LIBRARY-$(basename $(notdir $(shell pwd))))

$(LIBRARY-$(basename $(notdir $(shell pwd)))) :
	vlib $(basename $(notdir $(shell pwd))); vmap $(basename $(notdir $(shell pwd))) $(basename $(notdir $(shell pwd)))


# Rules for compiling single library units and their subhierarchy

afifo : \
		library \
		$(UNIT-$(basename $(notdir $(shell pwd)))-afifo) \
		$(UNIT-$(basename $(notdir $(shell pwd)))-afifo-rtl) \
		afifo_rptr_empty \
		afifo_wptr_full \
		dbl_sync \
		dpram

afifo_rptr_empty : \
		library \
		$(UNIT-$(basename $(notdir $(shell pwd)))-afifo_rptr_empty) \
		$(UNIT-$(basename $(notdir $(shell pwd)))-afifo_rptr_empty-rtl)

afifo_wptr_full : \
		library \
		$(UNIT-$(basename $(notdir $(shell pwd)))-afifo_wptr_full) \
		$(UNIT-$(basename $(notdir $(shell pwd)))-afifo_wptr_full-rtl)

cdc_pkg : \
		library \
		$(UNIT-$(basename $(notdir $(shell pwd)))-cdc_pkg)

dbl_sync : \
		library \
		$(UNIT-$(basename $(notdir $(shell pwd)))-dbl_sync) \
		$(UNIT-$(basename $(notdir $(shell pwd)))-dbl_sync-rtl)

dpram : \
		library \
		$(UNIT-$(basename $(notdir $(shell pwd)))-dpram) \
		$(UNIT-$(basename $(notdir $(shell pwd)))-dpram-rtl)


# Rules for compiling single library unit files

$(UNIT-$(basename $(notdir $(shell pwd)))-afifo) \
$(UNIT-$(basename $(notdir $(shell pwd)))-afifo-rtl) : \
		afifo.vhd \
		$(UNIT-$(basename $(notdir $(shell pwd)))-afifo_rptr_empty) \
		$(UNIT-$(basename $(notdir $(shell pwd)))-afifo_wptr_full) \
		$(UNIT-$(basename $(notdir $(shell pwd)))-dbl_sync) \
		$(UNIT-$(basename $(notdir $(shell pwd)))-dpram)
	$(COMPILE) $(OPTIONS) afifo.vhd

$(UNIT-$(basename $(notdir $(shell pwd)))-afifo_rptr_empty) \
$(UNIT-$(basename $(notdir $(shell pwd)))-afifo_rptr_empty-rtl) : \
		afifo_rptr_empty.vhd
	$(COMPILE) $(OPTIONS) afifo_rptr_empty.vhd

$(UNIT-$(basename $(notdir $(shell pwd)))-afifo_wptr_full) \
$(UNIT-$(basename $(notdir $(shell pwd)))-afifo_wptr_full-rtl) : \
		afifo_wptr_full.vhd
	$(COMPILE) $(OPTIONS) afifo_wptr_full.vhd

$(UNIT-$(basename $(notdir $(shell pwd)))-cdc_pkg) : \
		cdc_pkg.vhd
	$(COMPILE) $(OPTIONS) cdc_pkg.vhd

$(UNIT-$(basename $(notdir $(shell pwd)))-dbl_sync) \
$(UNIT-$(basename $(notdir $(shell pwd)))-dbl_sync-rtl) : \
		dbl_sync.vhd
	$(COMPILE) $(OPTIONS) dbl_sync.vhd

$(UNIT-$(basename $(notdir $(shell pwd)))-dpram) \
$(UNIT-$(basename $(notdir $(shell pwd)))-dpram-rtl) : \
		dpram.vhd
	$(COMPILE) $(OPTIONS) dpram.vhd


### Makefile ends here
VHDL_SRC = dpram.vhd dbl_sync.vhd afifo_rptr_empty.vhd afifo_wptr_full.vhd cdc_pkg.vhd afifo.vhd
SV_SRC = tb_afifo.sv

sim: 
	bsub -Ip vcom -work cdc $(VHDL_SRC)
	bsub -Ip vlog -work cdc $(SV_SRC)
	# bsub -Ip vhdlcom -nclib -work cdc $(VHDL_SRC)
	# bsub -Ip vericom -sv -nclib -work cdc $(SV_SRC)
	# bsub -Ip vopt +acc -fsmdebug -assertdebug tb_afifo -work cdc +cover=bcesfx -o opt -designfile design.bin -debug
	bsub -Ip vopt +acc -fsmdebug -assertdebug tb_afifo -work cdc +cover=bcesfx -o opt -debug
	bsub -Ip vsim -work cdc opt -do "add wave -r *;" -assertdebug